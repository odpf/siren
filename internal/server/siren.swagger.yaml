swagger: "2.0"
info:
  title: Siren APIs
  description: |-
    Documentation of our Siren API with gRPC and
    gRPC-Gateway.
  version: 0.3.0
tags:
- name: SirenService
schemes:
- http
consumes:
- application/json
produces:
- application/json
paths:
  /ping:
    get:
      summary: ping
      operationId: SirenService_Ping
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/PingResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      tags:
      - Ping
  /v1beta1/alerts/{provider_name}/{provider_id}:
    get:
      summary: list alerts
      operationId: SirenService_ListAlerts
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Alerts'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: provider_name
        in: path
        required: true
        type: string
      - name: provider_id
        in: path
        required: true
        type: string
        format: uint64
      - name: resource_name
        in: query
        required: false
        type: string
      - name: start_time
        in: query
        required: false
        type: string
        format: uint64
      - name: end_time
        in: query
        required: false
        type: string
        format: uint64
      tags:
      - Alert
  /v1beta1/alerts/cortex/{provider_id}:
    post:
      summary: create cortex alerts
      operationId: SirenService_CreateCortexAlerts
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Alerts'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: provider_id
        in: path
        required: true
        type: string
        format: uint64
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            alerts:
              type: array
              items:
                $ref: '#/definitions/CortexAlert'
      tags:
      - Alert
  /v1beta1/namespaces:
    get:
      summary: list namespaces
      operationId: SirenService_ListNamespaces
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/ListNamespacesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      tags:
      - Namespace
    post:
      summary: create a namespace
      operationId: SirenService_CreateNamespace
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Namespace'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/CreateNamespaceRequest'
      tags:
      - Namespace
  /v1beta1/namespaces/{id}:
    get:
      summary: get a namespace
      operationId: SirenService_GetNamespace
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Namespace'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Namespace
    delete:
      summary: delete a namespace
      operationId: SirenService_DeleteNamespace
      responses:
        "200":
          description: A successful response.
          schema:
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Namespace
    put:
      summary: update a namespace
      operationId: SirenService_UpdateNamespace
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Namespace'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            name:
              type: string
            provider:
              type: string
              format: uint64
            credentials:
              type: object
            labels:
              type: object
              additionalProperties:
                type: string
      tags:
      - Namespace
  /v1beta1/providers:
    get:
      summary: list providers
      operationId: SirenService_ListProviders
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/ListProvidersResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: urn
        in: query
        required: false
        type: string
      - name: type
        in: query
        required: false
        type: string
      tags:
      - Provider
    post:
      summary: create a provider
      operationId: SirenService_CreateProvider
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Provider'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/CreateProviderRequest'
      tags:
      - Provider
  /v1beta1/providers/{id}:
    get:
      summary: get a provider
      operationId: SirenService_GetProvider
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Provider'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Provider
    delete:
      summary: delete a provider
      operationId: SirenService_DeleteProvider
      responses:
        "200":
          description: A successful response.
          schema:
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Provider
    put:
      summary: update a provider
      operationId: SirenService_UpdateProvider
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Provider'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            host:
              type: string
            name:
              type: string
            type:
              type: string
            credentials:
              type: object
            labels:
              type: object
              additionalProperties:
                type: string
      tags:
      - Provider
  /v1beta1/receivers:
    get:
      summary: list receivers
      operationId: SirenService_ListReceivers
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/ListReceiversResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      tags:
      - Receiver
    post:
      summary: create a receiver
      operationId: SirenService_CreateReceiver
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Receiver'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/CreateReceiverRequest'
      tags:
      - Receiver
  /v1beta1/receivers/{id}:
    get:
      summary: get a receiver
      operationId: SirenService_GetReceiver
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Receiver'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Receiver
    delete:
      summary: delete a receiver
      operationId: SirenService_DeleteReceiver
      responses:
        "200":
          description: A successful response.
          schema:
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Receiver
    put:
      summary: update a receiver
      operationId: SirenService_UpdateReceiver
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Receiver'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            name:
              type: string
            type:
              type: string
            labels:
              type: object
              additionalProperties:
                type: string
            configurations:
              type: object
      tags:
      - Receiver
  /v1beta1/receivers/{id}/send:
    post:
      summary: send notification to receiver
      operationId: SirenService_SendReceiverNotification
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/SendReceiverNotificationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            slack:
              $ref: '#/definitions/SlackPayload'
      tags:
      - Receiver
  /v1beta1/rules:
    get:
      summary: list rules
      operationId: SirenService_ListRules
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/ListRulesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: name
        in: query
        required: false
        type: string
      - name: namespace
        in: query
        required: false
        type: string
      - name: group_name
        in: query
        required: false
        type: string
      - name: template
        in: query
        required: false
        type: string
      - name: provider_namespace
        in: query
        required: false
        type: string
        format: uint64
      tags:
      - Rule
    put:
      summary: add/update a rule
      operationId: SirenService_UpdateRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/UpdateRuleResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/UpdateRuleRequest'
      tags:
      - Rule
  /v1beta1/subscriptions:
    get:
      summary: List subscriptions
      operationId: SirenService_ListSubscriptions
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/ListSubscriptionsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      tags:
      - Subscription
    post:
      summary: Create a subscription
      operationId: SirenService_CreateSubscription
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Subscription'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/CreateSubscriptionRequest'
      tags:
      - Subscription
  /v1beta1/subscriptions/{id}:
    get:
      summary: Get a subscription
      operationId: SirenService_GetSubscription
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Subscription'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Subscription
    delete:
      summary: Delete a subscription
      operationId: SirenService_DeleteSubscription
      responses:
        "200":
          description: A successful response.
          schema:
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      tags:
      - Subscription
    put:
      summary: Update a subscription
      operationId: SirenService_UpdateSubscription
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/Subscription'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uint64
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            urn:
              type: string
            namespace:
              type: string
              format: uint64
            receivers:
              type: array
              items:
                $ref: '#/definitions/ReceiverMetadata'
            match:
              type: object
              additionalProperties:
                type: string
      tags:
      - Subscription
  /v1beta1/templates:
    get:
      summary: list templates
      operationId: SirenService_ListTemplates
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/ListTemplatesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: tag
        in: query
        required: false
        type: string
      tags:
      - Template
    put:
      summary: add/update a template
      operationId: SirenService_UpsertTemplate
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/TemplateResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/UpsertTemplateRequest'
      tags:
      - Template
  /v1beta1/templates/{name}:
    get:
      summary: get a template
      operationId: SirenService_GetTemplateByName
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/TemplateResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: name
        in: path
        required: true
        type: string
      tags:
      - Template
    delete:
      summary: delete a template
      operationId: SirenService_DeleteTemplate
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/DeleteTemplateResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: name
        in: path
        required: true
        type: string
      tags:
      - Template
  /v1beta1/templates/{name}/render:
    post:
      summary: render a template
      operationId: SirenService_RenderTemplate
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/RenderTemplateResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/Status'
      parameters:
      - name: name
        in: path
        required: true
        type: string
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            variables:
              type: object
              additionalProperties:
                type: string
      tags:
      - Template
definitions:
  Alert:
    type: object
    properties:
      id:
        type: string
        format: uint64
      provider_id:
        type: string
        format: uint64
      resource_name:
        type: string
      metric_name:
        type: string
      metric_value:
        type: string
      severity:
        type: string
      rule:
        type: string
      triggered_at:
        type: string
        format: date-time
  Alerts:
    type: object
    properties:
      alerts:
        type: array
        items:
          $ref: '#/definitions/Alert'
  Annotations:
    type: object
    properties:
      metric_name:
        type: string
      metric_value:
        type: string
      resource:
        type: string
      template:
        type: string
  Any:
    type: object
    properties:
      '@type':
        type: string
    additionalProperties: {}
  CortexAlert:
    type: object
    properties:
      annotations:
        $ref: '#/definitions/Annotations'
      labels:
        $ref: '#/definitions/Labels'
      status:
        type: string
      starts_at:
        type: string
        format: date-time
  CreateNamespaceRequest:
    type: object
    properties:
      name:
        type: string
      urn:
        type: string
      provider:
        type: string
        format: uint64
      credentials:
        type: object
      labels:
        type: object
        additionalProperties:
          type: string
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
  CreateProviderRequest:
    type: object
    properties:
      host:
        type: string
      urn:
        type: string
      name:
        type: string
      type:
        type: string
      credentials:
        type: object
      labels:
        type: object
        additionalProperties:
          type: string
  CreateReceiverRequest:
    type: object
    properties:
      name:
        type: string
      type:
        type: string
      labels:
        type: object
        additionalProperties:
          type: string
      configurations:
        type: object
  CreateSubscriptionRequest:
    type: object
    properties:
      urn:
        type: string
      namespace:
        type: string
        format: uint64
      receivers:
        type: array
        items:
          $ref: '#/definitions/ReceiverMetadata'
      match:
        type: object
        additionalProperties:
          type: string
  DeleteTemplateResponse:
    type: object
  Labels:
    type: object
    properties:
      severity:
        type: string
  ListNamespacesResponse:
    type: object
    properties:
      namespaces:
        type: array
        items:
          $ref: '#/definitions/Namespace'
  ListProvidersResponse:
    type: object
    properties:
      providers:
        type: array
        items:
          $ref: '#/definitions/Provider'
  ListReceiversResponse:
    type: object
    properties:
      receivers:
        type: array
        items:
          $ref: '#/definitions/Receiver'
  ListRulesResponse:
    type: object
    properties:
      rules:
        type: array
        items:
          $ref: '#/definitions/Rule'
  ListSubscriptionsResponse:
    type: object
    properties:
      subscriptions:
        type: array
        items:
          $ref: '#/definitions/Subscription'
  ListTemplatesResponse:
    type: object
    properties:
      templates:
        type: array
        items:
          $ref: '#/definitions/Template'
  Namespace:
    type: object
    properties:
      id:
        type: string
        format: uint64
      urn:
        type: string
      name:
        type: string
      provider:
        type: string
        format: uint64
      credentials:
        type: object
      labels:
        type: object
        additionalProperties:
          type: string
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
  NullValue:
    type: string
    enum:
    - NULL_VALUE
    default: NULL_VALUE
    description: |-
      `NullValue` is a singleton enumeration to represent the null value for the
      `Value` type union.

       The JSON representation for `NullValue` is JSON `null`.

       - NULL_VALUE: Null value.
  PingResponse:
    type: object
    properties:
      message:
        type: string
  Provider:
    type: object
    properties:
      id:
        type: string
        format: uint64
      host:
        type: string
      urn:
        type: string
      name:
        type: string
      type:
        type: string
      credentials:
        type: object
      labels:
        type: object
        additionalProperties:
          type: string
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
  Receiver:
    type: object
    properties:
      id:
        type: string
        format: uint64
      name:
        type: string
      type:
        type: string
      labels:
        type: object
        additionalProperties:
          type: string
      configurations:
        type: object
      data:
        type: object
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
  ReceiverMetadata:
    type: object
    properties:
      id:
        type: string
        format: uint64
      configuration:
        type: object
        additionalProperties:
          type: string
  RenderTemplateResponse:
    type: object
    properties:
      body:
        type: string
  Rule:
    type: object
    properties:
      id:
        type: string
        format: uint64
      name:
        type: string
      enabled:
        type: boolean
      group_name:
        type: string
      namespace:
        type: string
      template:
        type: string
      variables:
        type: array
        items:
          $ref: '#/definitions/Variables'
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
      provider_namespace:
        type: string
        format: uint64
  SendReceiverNotificationResponse:
    type: object
    properties:
      ok:
        type: boolean
  SlackPayload:
    type: object
    properties:
      message:
        type: string
      receiver_name:
        type: string
      receiver_type:
        type: string
      blocks:
        type: array
        items:
          type: object
  Status:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      details:
        type: array
        items:
          $ref: '#/definitions/Any'
  Subscription:
    type: object
    properties:
      id:
        type: string
        format: uint64
      urn:
        type: string
      namespace:
        type: string
        format: uint64
      receivers:
        type: array
        items:
          $ref: '#/definitions/ReceiverMetadata'
      match:
        type: object
        additionalProperties:
          type: string
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
  Template:
    type: object
    properties:
      id:
        type: string
        format: uint64
      name:
        type: string
      body:
        type: string
      tags:
        type: array
        items:
          type: string
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
      variables:
        type: array
        items:
          $ref: '#/definitions/TemplateVariables'
  TemplateResponse:
    type: object
    properties:
      template:
        $ref: '#/definitions/Template'
  TemplateVariables:
    type: object
    properties:
      name:
        type: string
      type:
        type: string
      default:
        type: string
      description:
        type: string
  UpdateRuleRequest:
    type: object
    properties:
      enabled:
        type: boolean
      group_name:
        type: string
      namespace:
        type: string
      template:
        type: string
      variables:
        type: array
        items:
          $ref: '#/definitions/Variables'
      provider_namespace:
        type: string
        format: uint64
  UpdateRuleResponse:
    type: object
    properties:
      rule:
        $ref: '#/definitions/Rule'
  UpsertTemplateRequest:
    type: object
    properties:
      id:
        type: string
        format: uint64
      name:
        type: string
      body:
        type: string
      tags:
        type: array
        items:
          type: string
      variables:
        type: array
        items:
          $ref: '#/definitions/TemplateVariables'
  Variables:
    type: object
    properties:
      name:
        type: string
      value:
        type: string
      type:
        type: string
      description:
        type: string
